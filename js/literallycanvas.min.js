!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.LC=t()}}(function(){return function t(e,n,o){function i(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(){},{}],2:[function(t,e){var n,o,i,r,s,a,h,c,l,u,p,d=[].slice;s=t("./actions"),a=t("./bindEvents"),c=t("./math"),p=t("./shapes"),h=p.createShape,l=p.shapeToJSON,o=p.JSONToShape,r=t("../tools/Pencil"),u=t("./util"),n="infinite",e.exports=i=function(){function t(t,e){this.containerEl=t,a(this,this.containerEl,e.keyboardShortcuts),this.colors={primary:e.primaryColor||"#000",secondary:e.secondaryColor||"#fff",background:e.backgroundColor||"transparent"},this.watermarkImage=e.watermarkImage,this.watermarkScale=e.watermarkScale||1,this.backgroundCanvas=document.createElement("canvas"),this.backgroundCtx=this.backgroundCanvas.getContext("2d"),this.containerEl.appendChild(this.backgroundCanvas),this.backgroundShapes=e.backgroundShapes||[],this.canvas=document.createElement("canvas"),this.canvas.style["background-color"]="transparent",this.containerEl.appendChild(this.canvas),this.buffer=document.createElement("canvas"),this.buffer.style["background-color"]="transparent",this.ctx=this.canvas.getContext("2d"),this.bufferCtx=this.buffer.getContext("2d"),this.backingScale=u.getBackingScale(this.ctx),this.shapes=[],this.undoStack=[],this.redoStack=[],this.isDragging=!1,this.position={x:0,y:0},this.scale=1,this.tool=new r,this.width=e.imageSize.width||n,this.height=e.imageSize.height||n,this.setZoom(this.scale),u.matchElementSize(this.containerEl,[this.backgroundCanvas,this.canvas],this.backingScale,function(t){return function(){return t.keepPanInImageBounds(),t.repaintAllLayers()}}(this))}return t.prototype.trigger=function(t,e){return this.canvas.dispatchEvent(new CustomEvent(t,{detail:e}))},t.prototype.on=function(t,e){var n;return n=function(t){return e(t.detail)},this.canvas.addEventListener(t,n),function(e){return function(){return e.canvas.removeEventListener(t,n)}}(this)},t.prototype.getRenderScale=function(){return this.scale*this.backingScale},t.prototype.clientCoordsToDrawingCoords=function(t,e){return{x:(t*this.backingScale-this.position.x)/this.getRenderScale(),y:(e*this.backingScale-this.position.y)/this.getRenderScale()}},t.prototype.drawingCoordsToClientCoords=function(t,e){return{x:t*this.getRenderScale()+this.position.x,y:e*this.getRenderScale()+this.position.y}},t.prototype.setTool=function(t){return this.tool=t,this.trigger("toolChange",{tool:t})},t.prototype.begin=function(t,e){return u.requestAnimationFrame(function(n){return function(){var o;return o=n.clientCoordsToDrawingCoords(t,e),n.tool.begin(o.x,o.y,n),n.isDragging=!0,n.trigger("drawStart",{tool:n.tool})}}(this))},t.prototype["continue"]=function(t,e){return u.requestAnimationFrame(function(n){return function(){var o;return o=n.clientCoordsToDrawingCoords(t,e),n.isDragging?(n.tool["continue"](o.x,o.y,n),n.trigger("drawContinue",{tool:n.tool})):void 0}}(this))},t.prototype.end=function(t,e){return u.requestAnimationFrame(function(n){return function(){var o;return o=n.clientCoordsToDrawingCoords(t,e),n.isDragging?(n.tool.end(o.x,o.y,n),n.isDragging=!1,n.trigger("drawEnd",{tool:n.tool})):void 0}}(this))},t.prototype.setColor=function(t,e){switch(this.colors[t]=e,t){case"background":this.containerEl.style.backgroundColor=this.colors.background,this.repaintLayer("background");break;case"primary":this.repaintLayer("main");break;case"secondary":this.repaintLayer("main")}return this.trigger(""+t+"ColorChange",this.colors[t]),"background"===t?this.trigger("drawingChange"):void 0},t.prototype.getColor=function(t){return this.colors[t]},t.prototype.saveShape=function(t,e,n){return null==e&&(e=!0),null==n&&(n=null),n||(n=this.shapes.length?this.shapes[this.shapes.length-1].id:null),this.execute(new s.AddShapeAction(this,t,n)),e&&this.trigger("shapeSave",{shape:t,previousShapeId:n}),this.trigger("drawingChange")},t.prototype.pan=function(t,e){return this.setPan(this.position.x-t,this.position.y-e)},t.prototype.keepPanInImageBounds=function(){var t,e,o,i;return t=this.getRenderScale(),i=this.position,e=i.x,o=i.y,this.width!==n&&(e=this.canvas.width>this.width*t?(this.canvas.width-this.width*t)/2:Math.max(Math.min(0,e),this.canvas.width-this.width*t)),this.height!==n&&(o=this.canvas.height>this.height*t?(this.canvas.height-this.height*t)/2:Math.max(Math.min(0,o),this.canvas.height-this.height*t)),this.position={x:e,y:o}},t.prototype.setPan=function(t,e){return this.position={x:t,y:e},this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("pan",{x:this.position.x,y:this.position.y})},t.prototype.zoom=function(t){var e;return e=this.scale+t,e=Math.max(e,.6),e=Math.min(e,4),e=Math.round(100*e)/100,this.setZoom(e)},t.prototype.setZoom=function(t){var e;return e=this.scale,this.scale=t,this.position.x=c.scalePositionScalar(this.position.x,this.canvas.width,e,this.scale),this.position.y=c.scalePositionScalar(this.position.y,this.canvas.height,e,this.scale),this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("zoom",{oldScale:e,newScale:this.scale})},t.prototype.repaintAllLayers=function(){var t,e,n,o;for(o=["background","main"],e=0,n=o.length;n>e;e++)t=o[e],this.repaintLayer(t);return null},t.prototype.repaintLayer=function(t,e){var n;switch(null==e&&(e="main"===t),t){case"background":this.backgroundCtx.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height),this.watermarkImage&&this._renderWatermark(),n=function(t){return function(){return t.repaintLayer("background")}}(this),this.draw(this.backgroundShapes,this.backgroundCtx,n);break;case"main":n=function(t){return function(){return t.repaintLayer("main",!0)}}(this),e&&(this.buffer.width=this.canvas.width,this.buffer.height=this.canvas.height,this.bufferCtx.clearRect(0,0,this.buffer.width,this.buffer.height),this.draw(this.shapes,this.bufferCtx,n)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width>0&&this.canvas.height>0&&(this.ctx.fillStyle="#ccc",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.clipped(function(t){return function(){return t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height),t.ctx.drawImage(t.buffer,0,0)}}(this),this.ctx))}return this.trigger("repaint",{layerKey:t})},t.prototype._renderWatermark=function(){return this.backgroundCtx.save(),this.backgroundCtx.translate(this.backgroundCanvas.width/2,this.backgroundCanvas.height/2),this.backgroundCtx.scale(this.watermarkScale*this.backingScale,this.watermarkScale*this.backingScale),this.backgroundCtx.drawImage(this.watermarkImage,-this.watermarkImage.width/2,-this.watermarkImage.height/2),this.backgroundCtx.restore()},t.prototype.drawShapeInProgress=function(t){return this.repaintLayer("main",!1),this.clipped(function(e){return function(){return e.transformed(function(){return t.drawLatest(e.ctx,e.bufferCtx)},e.ctx,e.bufferCtx)}}(this),this.ctx,this.bufferCtx)},t.prototype.draw=function(t,e,n){var o;if(t.length)return o=function(){return function(){var o,i,r,s;for(s=[],i=0,r=t.length;r>i;i++)o=t[i],s.push(o.draw(e,n));return s}}(this),this.clipped(function(t){return function(){return t.transformed(o,e)}}(this),e)},t.prototype.clipped=function(){var t,e,o,i,r,s,a,h,c,l,u,p;for(o=arguments[0],t=2<=arguments.length?d.call(arguments,1):[],s=this.width===n?0:this.position.x,a=this.height===n?0:this.position.y,r=function(){switch(this.width){case n:return this.canvas.width;default:return this.width*this.getRenderScale()}}.call(this),i=function(){switch(this.height){case n:return this.canvas.height;default:return this.height*this.getRenderScale()}}.call(this),h=0,l=t.length;l>h;h++)e=t[h],e.save(),e.beginPath(),e.rect(s,a,r,i),e.clip();for(o(),p=[],c=0,u=t.length;u>c;c++)e=t[c],p.push(e.restore());return p},t.prototype.transformed=function(){var t,e,n,o,i,r,s,a,h;for(n=arguments[0],t=2<=arguments.length?d.call(arguments,1):[],i=0,s=t.length;s>i;i++)e=t[i],e.save(),e.translate(this.position.x,this.position.y),o=this.getRenderScale(),e.scale(o,o);for(n(),h=[],r=0,a=t.length;a>r;r++)e=t[r],h.push(e.restore());return h},t.prototype.clear=function(){var t,e;return e=this.shapes,t=[],this.execute(new s.ClearAction(this,e,t)),this.repaintLayer("main"),this.trigger("clear",null),this.trigger("drawingChange",{})},t.prototype.execute=function(t){return this.undoStack.push(t),t["do"](),this.redoStack=[]},t.prototype.undo=function(){var t;if(this.undoStack.length)return t=this.undoStack.pop(),t.undo(),this.redoStack.push(t),this.trigger("undo",{action:t}),this.trigger("drawingChange",{})},t.prototype.redo=function(){var t;if(this.redoStack.length)return t=this.redoStack.pop(),this.undoStack.push(t),t["do"](),this.trigger("redo",{action:t}),this.trigger("drawingChange",{})},t.prototype.canUndo=function(){return!!this.undoStack.length},t.prototype.canRedo=function(){return!!this.redoStack.length},t.prototype.getPixel=function(t,e){var n,o;return n=this.drawingCoordsToClientCoords(t,e),o=this.ctx.getImageData(n.x,n.y,1,1).data,o[3]?"rgb("+o[0]+", "+o[1]+", "+o[2]+")":null},t.prototype.getContentBounds=function(){return u.getBoundingRect(this.shapes.map(function(t){return t.getBoundingRect()}),this.width===n?0:this.width,this.height===n?0:this.height)},t.prototype.getImage=function(t){var e;return null==t&&(t={}),null==t.rect&&(t.rect=this.getContentBounds()),t.rect.width&&t.rect.height?(null==t.scale&&(t.scale=1),null==t.scaleDownRetina&&(t.scaleDownRetina=!0),t.scaleDownRetina&&(t.scale/=this.backingScale),this.repaintLayer("main",!0),e={x:t.rect.x,y:t.rect.y,width:t.rect.width,height:t.rect.height,fillColor:this.colors.background,strokeColor:"transparent",strokeWidth:0},u.combineCanvases(u.renderShapes([h("Rectangle",e)].concat(this.backgroundShapes),t.rect,t.scale),u.renderShapes(this.shapes,t.rect,t.scale))):void 0},t.prototype.canvasForExport=function(){return this.repaintAllLayers(),u.combineCanvases(this.backgroundCanvas,this.canvas)},t.prototype.canvasWithBackground=function(t){return u.combineCanvases(t,this.canvasForExport())},t.prototype.getSnapshot=function(){var t;return{shapes:function(){var e,n,o,i;for(o=this.shapes,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(l(t));return i}.call(this),colors:this.colors}},t.prototype.getSnapshotJSON=function(){return JSON.stringify(this.getSnapshot())},t.prototype.loadSnapshot=function(t){var e,n,i,r,a,h,c,l,u;if(t){for(l=["primary","secondary","background"],r=0,h=l.length;h>r;r++)e=l[r],this.setColor(e,t.colors[e]);for(this.shapes=[],u=t.shapes,a=0,c=u.length;c>a;a++)i=u[a],n=o(i),n&&this.execute(new s.AddShapeAction(this,n));return this.repaintAllLayers(),this.trigger("snapshotLoad"),this.trigger("drawingChange",{})}},t.prototype.loadSnapshotJSON=function(t){return this.loadSnapshot(JSON.parse(t))},t}()},{"../tools/Pencil":29,"./actions":3,"./bindEvents":4,"./math":6,"./shapes":7,"./util":8}],3:[function(t,e){var n,o;o=function(){function t(t,e,n){this.lc=t,this.oldShapes=e,this.newShapes=n}return t.prototype["do"]=function(){return this.lc.shapes=this.newShapes,this.lc.repaintLayer("main")},t.prototype.undo=function(){return this.lc.shapes=this.oldShapes,this.lc.repaintLaye("main")},t}(),n=function(){function t(t,e,n){this.lc=t,this.shape=e,this.previousShapeId=null!=n?n:null}return t.prototype["do"]=function(){var t,e,n,o,i,r;if(this.lc.shapes.length&&this.lc.shapes[this.lc.shapes.length-1].id!==this.previousShapeId&&null!==this.previousShapeId){for(e=[],t=!1,r=this.lc.shapes,o=0,i=r.length;i>o;o++)n=r[o],e.push(n),n.id===this.previousShapeId&&(e.push(this.shape),t=!0);t||e.push(this.shape),this.lc.shapes=e}else this.lc.shapes.push(this.shape);return this.lc.repaintLayer("main")},t.prototype.undo=function(){var t,e,n,o,i;if(this.lc.shapes[this.lc.shapes.length-1].id===this.shape.id)this.lc.shapes.pop();else{for(t=[],i=this.lc.shapes,n=0,o=i.length;o>n;n++)e=i[n],e.id!==this.shape.id&&t.push(e);lc.shapes=t}return this.lc.repaintLayer("main")},t}(),e.exports={ClearAction:o,AddShapeAction:n}},{}],4:[function(t,e){var n,o,i,r;i=function(t,e){var n,o,i;return o=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY,n=t.getBoundingClientRect(),[o-n.left,i-n.top]},r=function(t,e){var n;return null!=e.offsetX?{left:e.offsetX,top:e.offsetY}:(n=t.getBoundingClientRect(),{left:e.clientX-n.left,top:e.clientY-n.top})},o=function(t){return null!=t.buttons?1===t.buttons:t.which>0},e.exports=n=function(t,e,n){return null==n&&(n=!1),e.addEventListener("mousedown",function(){return function(n){var o,i;return o=!0,n.preventDefault(),document.onselectstart=function(){return!1},i=r(e,n),t.begin(i.left,i.top)}}(this)),document.addEventListener("mousemove",function(){return function(n){var o;return n.preventDefault(),o=r(e,n),t["continue"](o.left,o.top)}}(this)),document.addEventListener("mouseup",function(){return function(n){var o;return n.preventDefault(),document.onselectstart=function(){return!0},o=r(e,n),t.end(o.left,o.top)}}(this)),e.addEventListener("touchstart",function(n){return n.preventDefault(),1===n.touches.length?t.begin.apply(t,i(e,n)):t["continue"].apply(t,i(e,n))}),e.addEventListener("touchmove",function(n){return n.preventDefault(),t["continue"].apply(t,i(e,n))}),e.addEventListener("touchend",function(n){return n.preventDefault(),t.end.apply(t,i(e,n))}),e.addEventListener("touchcancel",function(n){return n.preventDefault(),t.end.apply(t,i(e,n))}),n?document.addEventListener("keydown",function(e){switch(e.keyCode){case 37:t.pan(-10,0);break;case 38:t.pan(0,-10);break;case 39:t.pan(10,0);break;case 40:t.pan(0,10)}return t.repaintAllLayers()}):void 0}},{}],5:[function(t,e){var n,o,i;o={},n=function(t){return o=t},i=function(t){var e;return e=o[t],e||t},e.exports={localize:n,_:i}},{}],6:[function(t,e){var n,o,i,r,s,a;n=t("./shapes").Point,s=t("./util"),o={},o.toPoly=function(t){var e,n,o,r,s,h,c;for(r=[],s=[],e=0,h=0,c=t.length;c>h;h++)o=t[h],n=i(o,a(t,e)),r=r.concat([n[0]]),s=[n[1]].concat(s),e+=1;return r.concat(s)},a=function(t,e){var n;return t.length<3&&(n={x:0,y:0}),n=0===e?a(t,e+1):e===t.length-1?a(t,e-1):o.diff(t[e-1],t[e+1])},o.diff=function(t,e){return{x:e.x-t.x,y:e.y-t.y}},r=function(t){var e;return e=o.len(t),{x:t.x/e,y:t.y/e}},i=function(t,e){return e=r(e),e.x=e.x*t.size/2,e.y=e.y*t.size/2,[{x:t.x-e.y,y:t.y+e.x,color:t.color},{x:t.x+e.y,y:t.y-e.x,color:t.color}]},o.len=function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))},o.scalePositionScalar=function(t,e,n,o){var i,r;return r=e*n,i=e*o,t+(r-i)/2},e.exports=o},{"./shapes":7,"./util":8}],7:[function(t,e){var n,o,i,r,s,a,h,c,l,u,p,d,f,g,y=[].slice;l=t("./util"),c={},s=function(t,e){var n,o;n=function(){var t,n;return t=1<=arguments.length?y.call(arguments,0):[],(n=e.constructor).call.apply(n,[this].concat(y.call(t))),this},n.prototype.className=t,n.fromJSON=e.fromJSON,n.prototype.drawLatest=function(t,e){return this.draw(t,e)};for(o in e)"fromJSON"!==o&&(n.prototype[o]=e[o]);return c[t]=n,n},r=function(){var t,e,n;return e=arguments[0],t=2<=arguments.length?y.call(arguments,1):[],n=function(t,e,n){n.prototype=t.prototype;var o=new n,i=t.apply(o,e);return Object(i)===i?i:o}(c[e],t,function(){}),n.id=l.getGUID(),n},n=function(t){var e,n,o,i;return e=t.className,n=t.data,o=t.id,e in c?(i=c[e].fromJSON(n),i?(o&&(i.id=o),i):(console.log("Unreadable shape:",e,n),null)):(console.log("Unknown shape:",e,n),null)},h=function(t){return{className:t.className,data:t.toJSON(),id:t.id}},i=function(t,e){return e?i(d(d(g(t))),e-1):t},g=function(t){var e,n,o,i,r;for(t=[t[0]].concat(t).concat(l.last(t)),o=[],e=0,i=0,r=t.length;r>i;i++)n=t[i],o[2*e]=n,t[e+1]&&(o[2*e+1]=f(n,t[e+1])),e+=1;return o},d=function(t){var e,n,o,i,r;for(e=[],n=0,i=0,r=t.length;r>i;i++)o=t[i],t[n+1]&&(e[n]=f(o,t[n+1])),n+=1;return e},f=function(t,e){return r("Point",{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2,size:t.size+(e.size-t.size)/2,color:t.color})},s("Image",{constructor:function(t){return null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.image=t.image||null},draw:function(t,e){return this.image.width?t.drawImage(this.image,this.x,this.y):this.image.onload=e},getBoundingRect:function(){return{x:this.x,y:this.y,width:this.image.width,height:this.image.height}},toJSON:function(){return{x:this.x,y:this.y,imageSrc:this.image.src}},fromJSON:function(t){var e;return e=new Image,e.src=t.imageSrc,r("Image",{x:t.x,x:t.y,image:e})}}),s("Rectangle",{constructor:function(t){return null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.strokeWidth=t.strokeWidth||1,this.strokeColor=t.strokeColor||"black",this.fillColor=t.fillColor||"transparent"},draw:function(t){return t.fillStyle=this.fillColor,t.fillRect(this.x,this.y,this.width,this.height),t.lineWidth=this.strokeWidth,t.strokeStyle=this.strokeColor,t.strokeRect(this.x,this.y,this.width,this.height)},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(t){return r("Rectangle",t)}}),s("Ellipse",{constructor:function(t){return null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.width=t.width||0,this.height=t.height||0,this.strokeWidth=t.strokeWidth||1,this.strokeColor=t.strokeColor||"black",this.fillColor=t.fillColor||"transparent"},draw:function(t){var e,n,o,i;return t.save(),i=Math.floor(this.width/2),o=Math.floor(this.height/2),e=this.x+i,n=this.y+o,t.translate(e,n),t.scale(1,Math.abs(this.height/this.width)),t.beginPath(),t.arc(0,0,Math.abs(i),0,2*Math.PI),t.closePath(),t.restore(),t.fillStyle=this.fillColor,t.fill(),t.lineWidth=this.strokeWidth,t.strokeStyle=this.strokeColor,t.stroke()},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(t){return r("Ellipse",t)}}),s("Line",{constructor:function(t){return null==t&&(t={}),this.x1=t.x1||0,this.y1=t.y1||0,this.x2=t.x2||0,this.y2=t.y2||0,this.strokeWidth=t.strokeWidth||1,this.color=t.color||"black"},draw:function(t){return t.lineWidth=this.strokeWidth,t.strokeStyle=this.color,t.lineCap="round",t.beginPath(),t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2),t.stroke()},getBoundingRect:function(){return{x:Math.min(this.x1,this.x2)-this.strokeWidth/2,y:Math.min(this.y1,this.y2)-this.strokeWidth/2,width:Math.abs(this.x2-this.x1)+this.strokeWidth/2,height:Math.abs(this.y2-this.y1)+this.strokeWidth/2}},toJSON:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,strokeWidth:this.strokeWidth,color:this.color}},fromJSON:function(t){return r("Line",t)}}),p=function(t){var e,n,o,i,r;if(!t.length)return!1;for(o=t[0].size,e=t[0].color,i=0,r=t.length;r>i;i++)if(n=t[i],n.size!==o||n.color!==e)return!1;return!0},u=function(t,e){var o,i,s,a;return i=null,e.points?i=function(){var t,i,r,s;for(r=e.points,s=[],t=0,i=r.length;i>t;t++)o=r[t],s.push(n(o));return s}():e.pointCoordinatePairs&&(i=function(){var t,o,i,r,h;for(i=e.pointCoordinatePairs,h=[],t=0,o=i.length;o>t;t++)r=i[t],s=r[0],a=r[1],h.push(n({className:"Point",data:{x:s,y:a,size:e.pointSize,color:e.pointColor}}));return h}()),i[0]?r(t,{points:i,order:e.order,tailSize:e.tailSize}):null},a={constructor:function(t){var e,n,o,i,r;for(null==t&&(t={}),n=t.points||[],this.order=t.order||3,this.tailSize=t.tailSize||3,this.segmentSize=Math.pow(2,this.order),this.sampleSize=this.tailSize+1,this.points=[],r=[],o=0,i=n.length;i>o;o++)e=n[o],r.push(this.addPoint(e));return r},getBoundingRect:function(){return l.getBoundingRect(this.points.map(function(t){return{x:t.x-t.size/2,y:t.y-t.size/2,width:t.size,height:t.size}}))},toJSON:function(){var t,e;return p(this.points)?{order:this.order,tailSize:this.tailSize,pointCoordinatePairs:function(){var t,n,o,i;for(o=this.points,i=[],t=0,n=o.length;n>t;t++)e=o[t],i.push([e.x,e.y]);return i}.call(this),pointSize:this.points[0].size,pointColor:this.points[0].color}:{order:this.order,tailSize:this.tailSize,points:function(){var e,n,o,i;for(o=this.points,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(h(t));return i}.call(this)}},fromJSON:function(t){return u("LinePath",t)},draw:function(t){return this.drawPoints(t,this.smoothedPoints)},drawLatest:function(t,e){var n,o,i;return this.drawPoints(t,this.tail?this.tail:this.smoothedPoints),this.tail?(i=this.smoothedPoints.length-this.segmentSize*this.tailSize,o=i<2*this.segmentSize?0:i,n=i+this.segmentSize+1,this.drawPoints(e,this.smoothedPoints.slice(o,n))):void 0},addPoint:function(t){return this.points.push(t),!this.smoothedPoints||this.points.length<this.sampleSize?this.smoothedPoints=i(this.points,this.order):(this.tail=l.last(i(l.last(this.points,this.sampleSize),this.order),this.segmentSize*this.tailSize),this.smoothedPoints=this.smoothedPoints.slice(0,this.smoothedPoints.length-this.segmentSize*(this.tailSize-1)).concat(this.tail))},drawPoints:function(t,e){var n,o,i,r;if(e.length){for(t.lineCap="round",t.strokeStyle=e[0].color,t.lineWidth=e[0].size,t.beginPath(),t.moveTo(e[0].x,e[0].y),r=e.slice(1),o=0,i=r.length;i>o;o++)n=r[o],t.lineTo(n.x,n.y);return t.stroke()}}},o=s("LinePath",a),s("ErasedLinePath",{constructor:a.constructor,toJSON:a.toJSON,addPoint:a.addPoint,drawPoints:a.drawPoints,getBoundingRect:a.getBoundingRect,draw:function(t){return t.save(),t.globalCompositeOperation="destination-out",a.draw.call(this,t),t.restore()},drawLatest:function(t,e){return t.save(),t.globalCompositeOperation="destination-out",e.save(),e.globalCompositeOperation="destination-out",a.drawLatest.call(this,t,e),t.restore(),e.restore()},fromJSON:function(t){return u("ErasedLinePath",t)}}),s("Point",{constructor:function(t){return null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.size=t.size||0,this.color=t.color||""},lastPoint:function(){return this},draw:function(){throw"not implemented"},toJSON:function(){return{x:this.x,y:this.y,size:this.size,color:this.color}},fromJSON:function(t){return r("Point",t)}}),s("Text",{constructor:function(t){return null==t&&(t={}),this.x=t.x||0,this.y=t.y||0,this.text=t.text||"",this.color=t.color||"black",this.font=t.font||"18px sans-serif"},draw:function(t){return t.font=this.font,t.fillStyle=this.color,t.fillText(this.text,this.x,this.y),this.boundingBoxWidth=Math.ceil(t.measureText(this.text).width)},getBoundingRect:function(){return{x:this.x,y:this.y,width:this.boundingBoxWidth,height:18}},toJSON:function(){return{x:this.x,y:this.y,text:this.text,color:this.color,font:this.font}},fromJSON:function(t){return r("Text",t)}}),e.exports={defineShape:s,createShape:r,JSONToShape:n,shapeToJSON:h}},{"./util":8}],8:[function(t,e){var n,o;n=Array.prototype.slice,o={last:function(t,e){return null==e&&(e=null),e?n.call(t,Math.max(t.length-e,0)):t[t.length-1]},matchElementSize:function(t,e,n,o){var i;return null==o&&(o=function(){}),i=function(){return function(){var i,r,s;for(r=0,s=e.length;s>r;r++)i=e[r],i.style.width=""+t.offsetWidth+"px",i.style.height=""+t.offsetHeight+"px",null!=i.width&&(i.setAttribute("width",i.offsetWidth*n),i.setAttribute("height",i.offsetHeight*n));return o()}}(this),t.addEventListener("resize",i),window.addEventListener("resize",i),window.addEventListener("orientationchange",i),i()},combineCanvases:function(t,e){var n,o;return n=document.createElement("canvas"),n.width=Math.max(t.width,e.width),n.height=Math.max(t.height,e.height),o=n.getContext("2d"),o.drawImage(t,0,0),o.drawImage(e,0,0),n},renderShapes:function(t,e,n,o){var i,r,s,a;for(null==n&&(n=1),null==o&&(o=null),o=o||document.createElement("canvas"),o.width=e.width*n,o.height=e.height*n,i=o.getContext("2d"),i.translate(-e.x*n,-e.y*n),i.scale(n,n),s=0,a=t.length;a>s;s++)r=t[s],r.draw(i);return o},getBoundingRect:function(t,e,n){var o,i,r,s,a,h,c;if(!t.length)return{x:0,y:0,width:0||e,height:0||n};for(r=t[0].x,s=t[0].y,o=t[0].x+t[0].width,i=t[0].y+t[0].height,h=0,c=t.length;c>h;h++)a=t[h],r=Math.floor(Math.min(a.x,r)),s=Math.floor(Math.min(a.y,s)),o=Math.ceil(Math.max(o,a.x+a.width)),i=Math.ceil(Math.max(i,a.y+a.height));return r=e?0:r,s=n?0:s,o=e||o,i=n||i,{x:r,y:s,width:o-r,height:i-s}},getBackingScale:function(){return null==window.devicePixelRatio?1:window.devicePixelRatio>1?window.devicePixelRatio:1},requestAnimationFrame:(window.requestAnimationFrame||window.setTimeout).bind(window),getGUID:function(){var t;return t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}()},e.exports=o},{}],9:[function(t,e){var n,o,i,r,s,a,h,c,l,u,p,d;n=t("./core/LiterallyCanvas"),a=t("./reactGUI/init"),u=t("./core/shapes"),d=t("./core/util"),h=t("./core/localization").localize,t("./optionsStyles/font"),t("./optionsStyles/stroke-width"),t("./optionsStyles/null"),r=t("./optionsStyles/optionsStyles").defineOptionsStyle,o=t("./tools/base"),p={Pencil:t("./tools/Pencil"),Eraser:t("./tools/Eraser"),Line:t("./tools/Line"),Rectangle:t("./tools/Rectangle"),Ellipse:t("./tools/Ellipse"),Text:t("./tools/Text"),Pan:t("./tools/Pan"),Eyedropper:t("./tools/Eyedropper"),Tool:o.Tool,ToolWithStroke:o.ToolWithStroke},i="lib/img",l=function(t){return i=t},s=function(t,e){var o,r,s,h,c,l,u,d;null==e&&(e={}),null==e.imageURLPrefix&&(e.imageURLPrefix=i),null==e.primaryColor&&(e.primaryColor="#000"),null==e.secondaryColor&&(e.secondaryColor="#fff"),null==e.backgroundColor&&(e.backgroundColor="transparent"),null==e.keyboardShortcuts&&(e.keyboardShortcuts=!0),null==e.imageSize&&(e.imageSize={width:"infinite",height:"infinite"}),null==e.backgroundShapes&&(e.backgroundShapes=[]),null==e.watermarkImage&&(e.watermarkImage=null),null==e.watermarkScale&&(e.watermarkScale=1),"tools"in e||(e.tools=[p.Pencil,p.Eraser,p.Line,p.Rectangle,p.Ellipse,p.Text,p.Pan,p.Eyedropper]),d=t.children;for(l=0,u=d.length;u>l;l++)o=d[l],t.removeChild(o);return-1===[" "," "].join(t.className).indexOf(" literally ")&&(t.className=t.className+" literally"),c=document.createElement("div"),c.className="lc-picker",r=document.createElement("div"),r.className="lc-drawing",h=document.createElement("div"),h.className="lc-options",t.appendChild(c),t.appendChild(r),t.appendChild(h),s=new n(r,e),a(c,h,s,e.tools,e.imageURLPrefix),"onInit"in e&&e.onInit(s),s},c=function(t){return t.fn.literallycanvas=function(t){return null==t&&(t={}),this.each(function(){return function(e,n){return n.literallycanvas=s(n,t)}}(this)),this}},window.LC={init:s},window.$&&c(window.$),e.exports={init:s,registerJQueryPlugin:c,util:d,tools:p,defineOptionsStyle:r,setDefaultImageURLPrefix:l,defineShape:u.defineShape,createShape:u.createShape,JSONToShape:u.JSONToShape,shapeToJSON:u.shapeToJSON,localize:h}},{"./core/LiterallyCanvas":2,"./core/localization":5,"./core/shapes":7,"./core/util":8,"./optionsStyles/font":10,"./optionsStyles/null":11,"./optionsStyles/optionsStyles":12,"./optionsStyles/stroke-width":13,"./reactGUI/init":23,"./tools/Ellipse":24,"./tools/Eraser":25,"./tools/Eyedropper":26,"./tools/Line":27,"./tools/Pan":28,"./tools/Pencil":29,"./tools/Rectangle":30,"./tools/Text":31,"./tools/base":32}],10:[function(t,e){var n,o;n=t("./optionsStyles").defineOptionsStyle,o=t("../core/localization")._,n("font",React.createClass({displayName:"FontOptions",getText:function(){var t;return null!=(t=this.props.lc.tool)?t.text:void 0},getInitialState:function(){return{text:this.getText(),isItalic:!1,isBold:!1,fontFamilyIndex:0,fontSizeIndex:4}},getFontSizes:function(){return[9,10,12,14,18,24,36,48,64,72,96,144,288]},getFamilies:function(){var t;return t=this.props.lc,[{name:o("Sans-serif"),value:'"Helvetica Neue",Helvetica,Arial,sans-serif'},{name:o("Serif"),value:'"Hoefler Text","Times New Roman",serif'},{name:o("Typewriter"),value:'"Lucida Typewriter",monospace'}]},updateTool:function(t){var e,n,o;null==t&&(t={});for(o in this.state)o in t||(t[o]=this.state[o]);return e=this.getFontSizes()[t.fontSizeIndex],n=[],t.isItalic&&n.push("italic"),t.isBold&&n.push("bold"),n.push(""+e+"px"),n.push(this.getFamilies()[t.fontFamilyIndex].value),this.props.lc.tool.font=n.join(" ")},handleText:function(t){return this.props.lc.tool.text=t.target.value,this.setState({text:this.getText()})},handleFontSize:function(t){var e;return e={fontSizeIndex:t.target.value},this.setState(e),this.updateTool(e)},handleFontFamily:function(t){var e;return e={fontFamilyIndex:t.target.value},this.setState(e),this.updateTool(e)},handleItalic:function(){var t;return t={isItalic:!this.state.isItalic},this.setState(t),this.updateTool(t)},handleBold:function(){var t;return t={isBold:!this.state.isBold},this.setState(t),this.updateTool(t)},componentDidMount:function(){return this.updateTool()},render:function(){var t,e,n,i,r,s,a,h,c;return r=this.props.lc,c=React.DOM,e=c.div,n=c.input,a=c.select,s=c.option,t=c.br,i=c.label,h=c.span,e({className:"lc-font-settings"},n({type:"text",placeholder:o("Enter text here"),value:this.state.text,onChange:this.handleText}),h({className:"instructions"},o("Click and hold to place text.")),t(),o("Size: "),a({value:this.state.fontSizeIndex,onChange:this.handleFontSize},this.getFontSizes().map(function(){return function(t,e){return s({value:e,key:e},t)}}(this))),a({value:this.state.fontFamilyIndex,onChange:this.handleFontFamily},this.getFamilies().map(function(){return function(t,e){return s({value:e,key:e},t.name)}}(this))),i({htmlFor:"italic"},n({type:"checkbox",id:"italic",checked:this.state.isItalic,onChange:this.handleItalic},o("italic"))),i({htmlFor:"bold"},n({type:"checkbox",id:"bold",checked:this.state.isBold,onChange:this.handleBold},o("bold"))))}})),e.exports={}},{"../core/localization":5,"./optionsStyles":12}],11:[function(t,e){var n;n=t("./optionsStyles").defineOptionsStyle,n("null",React.createClass({displayName:"NoOptions",render:function(){return React.DOM.div()}})),e.exports={}},{"./optionsStyles":12}],12:[function(t,e){var n,o;o={},n=function(t,e){return o[t]=e},e.exports={optionsStyles:o,defineOptionsStyle:n}},{}],13:[function(t,e){var n,o;n=t("../reactGUI/createSetStateOnEventMixin"),o=t("./optionsStyles").defineOptionsStyle,o("stroke-width",React.createClass({displayName:"StrokeWidths",getState:function(){var t;return{strokeWidth:null!=(t=this.props.lc.tool)?t.strokeWidth:void 0}},getInitialState:function(){return this.getState()},mixins:[n("toolChange")],render:function(){var t,e,n,o,i,r,s,a;return a=React.DOM,s=a.ul,o=a.li,r=a.svg,t=a.circle,e=a.div,i=[1,2,5,10,20,30],n=function(){return function(){}}(this),s({className:"lc-stroke-widths"},i.map(function(n){return function(i){var s,a;return s=React.addons.classSet({"stroke-width-button":!0,selected:i===n.state.strokeWidth}),a=40,o({className:"lc-stroke-width",key:i},e({className:s,onClick:function(){return n.props.tool.strokeWidth=i,n.setState(n.getState())}},r({width:a,height:a,viewPort:"0 0 "+i+" "+i,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},t({cx:Math.ceil(a/2),cy:Math.ceil(a/2),r:i/2}))))}}(this)))}})),e.exports={}},{"../reactGUI/createSetStateOnEventMixin":21,"./optionsStyles":12}],14:[function(t,e){var n,o,i,r;o=t("./React-shim"),i=t("./createSetStateOnEventMixin"),r=t("../core/localization")._,n=o.createClass({displayName:"ClearButton",getState:function(){return{isEnabled:this.props.lc.canUndo()}},getInitialState:function(){return this.getState()},mixins:[i("drawingChange")],render:function(){var t,e,n,i;
return e=o.DOM.div,n=this.props.lc,t=o.addons.classSet({"lc-clear":!0,"toolbar-button":!0,"fat-button":!0,disabled:!this.state.isEnabled}),i=n.canUndo()?function(){return function(){return n.clear()}}(this):function(){},e({className:t,onClick:i},r("Clear"))}}),e.exports=n},{"../core/localization":5,"./React-shim":18,"./createSetStateOnEventMixin":21}],15:[function(t,e){var n,o;o=t("./React-shim"),n=o.createClass({displayName:"ColorWell",getState:function(){return{color:this.props.lc.colors[this.props.colorName],isPickerVisible:!1}},getInitialState:function(){return this.getState()},componentDidMount:function(){return this.unsubscribe=this.props.lc.on(""+this.props.colorName+"ColorChange",function(t){return function(){return t.setState({color:t.props.lc.colors[t.props.colorName]})}}(this))},componentWillUnmount:function(){return this.unsubscribe()},togglePicker:function(){return this.setState({isPickerVisible:!this.state.isPickerVisible})},closePicker:function(){return this.setState({isPickerVisible:!1})},setColor:function(t){return this.props.lc.setColor(this.props.colorName,t)},render:function(){var t,e,n;return n=o.DOM,t=n.div,e=n.label,t({className:"toolbar-button color-well-label",onMouseLeave:this.closePicker,onClick:this.togglePicker},e({style:{display:"block",clear:"both"}},this.props.label),t({className:o.addons.classSet({"color-well-container":!0,selected:this.state.isPickerVisible}),style:{backgroundColor:"white"}},t({className:"color-well-checker"}),t({className:"color-well-checker",style:{left:"50%",top:"50%"}}),t({className:"color-well-color",style:{backgroundColor:this.state.color}}," "),this.renderPicker()))},renderPicker:function(){var t,e,n,i,r,s,a,h;if(t=o.DOM.div,!this.state.isPickerVisible)return null;for(i=function(e){return function(){return t({className:"color-row",key:0,style:{height:20}},t({className:o.addons.classSet({"color-cell transparent-cell":!0,selected:"transparent"===e.state.color}),onClick:function(){return e.setColor("transparent")}},"transparent"))}}(this),r=[],"background"===this.props.colorName&&r.push("transparent"),r.push(function(){var t,e;for(e=[],n=t=0;100>=t;n=t+=10)e.push("hsl(0, 0%, "+n+"%)");return e}()),h=[0,30,60,90,120,150,180,210,240,270,300,330],s=0,a=h.length;a>s;s++)e=h[s],r.push(function(){var t,o;for(o=[],n=t=10;90>=t;n=t+=8)o.push("hsl("+e+", 100%, "+n+"%)");return o}());return t({className:"color-picker-popup"},r.map(function(e){return function(n,r){return"transparent"===n?i():t({className:"color-row",key:r,style:{width:20*n.length}},n.map(function(n,i){var r;return r=o.addons.classSet({"color-cell":!0,selected:e.state.color===n}),t({className:r,onClick:function(){return e.setColor(n)},style:{backgroundColor:n},key:i})}))}}(this)))}}),e.exports=n},{"./React-shim":18}],16:[function(t,e){var n,o,i,r;o=t("./React-shim"),i=t("./createSetStateOnEventMixin"),r=t("../optionsStyles/optionsStyles").optionsStyles,n=o.createClass({displayName:"Options",getState:function(){var t;return{style:null!=(t=this.props.lc.tool)?t.optionsStyle:void 0,tool:this.props.lc.tool}},getInitialState:function(){return this.getState()},mixins:[i("toolChange")],render:function(){var t;return t=""+this.state.style,r[t]({lc:this.props.lc,tool:this.state.tool})}}),e.exports=n},{"../optionsStyles/optionsStyles":12,"./React-shim":18,"./createSetStateOnEventMixin":21}],17:[function(t,e){var n,o,i,r,s,a,h,c;s=t("./React-shim"),n=t("./ClearButton"),i=t("./ColorWell"),a=t("./UndoRedoButtons"),h=t("./ZoomButtons"),c=t("../core/localization")._,o=s.createClass({displayName:"ColorPickers",render:function(){var t,e;return e=this.props.lc,(t=s.DOM.div)({className:"lc-color-pickers"},i({lc:e,colorName:"background",label:c("background")}),i({lc:e,colorName:"primary",label:c("stroke")}),i({lc:e,colorName:"secondary",label:c("fill")}))}}),r=s.createClass({displayName:"Picker",getInitialState:function(){return{selectedToolIndex:0}},render:function(){var t,e,i,r,c;return t=s.DOM.div,c=this.props,r=c.toolButtonComponents,i=c.lc,e=c.imageURLPrefix,t({className:"lc-picker-contents"},r.map(function(t){return function(n,o){return n({lc:i,imageURLPrefix:e,key:o,isSelected:o===t.state.selectedToolIndex,onSelect:function(e){return i.setTool(e),t.setState({selectedToolIndex:o})}})}}(this)),r.length%2!==0?t({className:"toolbar-button thin-button disabled"}):void 0,a({lc:i,imageURLPrefix:e}),h({lc:i}),n({lc:i}),o({lc:i}))}}),e.exports=r},{"../core/localization":5,"./ClearButton":14,"./ColorWell":15,"./React-shim":18,"./UndoRedoButtons":19,"./ZoomButtons":20}],18:[function(t,e){var n;try{n=t("React/addons")}catch(o){n=window.React}if(null==(null!=n?n.addons:void 0))throw"Can't find React (you need the version with addons)";e.exports=n},{}],19:[function(t,e){var n,o,i,r,s,a;n=t("./React-shim"),s=t("./createSetStateOnEventMixin"),a=function(t){return n.createClass({displayName:"undo"===t?"UndoButton":"RedoButton",getState:function(){return{isEnabled:function(){switch(!1){case"undo"!==t:return this.props.lc.canUndo();case"redo"!==t:return this.props.lc.canRedo()}}.call(this)}},getInitialState:function(){return this.getState()},mixins:[s("drawingChange")],render:function(){var e,o,i,r;return o=n.DOM.div,i=this.props.lc,e="lc-"+t+" "+n.addons.classSet({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled}),r=function(){switch(!1){case!!this.state.isEnabled:return function(){};case"undo"!==t:return function(){return i.undo()};case"redo"!==t:return function(){return i.redo()}}}.call(this),o({className:e,onClick:r,dangerouslySetInnerHTML:{__html:"undo"===t?"&larr;":"&rarr;"}})}})},i=a("undo"),o=a("redo"),r=n.createClass({displayName:"UndoRedoButtons",render:function(){var t,e;return t=n.DOM.div,e=this.props.lc,t({className:"lc-undo-redo"},i({lc:e}),o({lc:e}))}}),e.exports=r},{"./React-shim":18,"./createSetStateOnEventMixin":21}],20:[function(t,e){var n,o,i,r,s,a;n=t("./React-shim"),s=t("./createSetStateOnEventMixin"),a=function(t){return n.createClass({displayName:"in"===t?"ZoomInButton":"ZoomOutButton",getState:function(){return{isEnabled:function(){switch(!1){case"in"!==t:return this.props.lc.scale<4;case"out"!==t:return this.props.lc.scale>.6}}.call(this)}},getInitialState:function(){return this.getState()},mixins:[s("zoom")],render:function(){var e,o,i,r;return o=n.DOM.div,i=this.props.lc,e="lc-zoom-"+t+" "+n.addons.classSet({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled}),r=function(){switch(!1){case!!this.state.isEnabled:return function(){};case"in"!==t:return function(){return i.zoom(.2)};case"out"!==t:return function(){return i.zoom(-.2)}}}.call(this),o({className:e,onClick:r},function(){switch(!1){case"in"!==t:return"+";case"out"!==t:return"-"}}())}})},r=a("out"),i=a("in"),o=n.createClass({displayName:"ZoomButtons",render:function(){var t,e;return t=n.DOM.div,e=this.props.lc,t({className:"lc-zoom"},r({lc:e}),i({lc:e}))}}),e.exports=o},{"./React-shim":18,"./createSetStateOnEventMixin":21}],21:[function(t,e){var n,o;n=t("./React-shim"),e.exports=o=function(t){return{componentDidMount:function(){return this.unsubscribe=this.props.lc.on(t,function(t){return function(){return t.setState(t.getState())}}(this))},componentWillUnmount:function(){return this.unsubscribe()}}}},{"./React-shim":18}],22:[function(t,e){var n,o;n=t("./React-shim"),o=function(t){var e,o,i,r;return e=t.displayName,o=t.getTool,i=t.imageName,r=o(),n.createClass({displayName:e,getDefaultProps:function(){return{isSelected:!1,lc:null}},componentWillMount:function(){return this.props.isSelected?this.props.lc.setTool(r):void 0},render:function(){var t,e,o,s,a,h,c,l;return c=n.DOM,e=c.div,s=c.img,l=this.props,o=l.imageURLPrefix,a=l.isSelected,h=l.onSelect,t=n.addons.classSet({"lc-pick-tool":!0,"toolbar-button":!0,"thin-button":!0,selected:a}),e({className:t,onClick:function(){return h(r)}},s({className:"lc-tool-icon",src:""+o+"/"+i+".png"}))}})},e.exports=o},{"./React-shim":18}],23:[function(t,e){var n,o,i,r,s;i=t("./React-shim"),r=t("./createToolButton"),n=t("./Options"),o=t("./Picker"),s=function(t,e,s,a,h){var c;return c=a.map(function(t){var e;return e=new t,r({displayName:e.name,imageName:e.iconName,getTool:function(){return e}})}),i.renderComponent(o({lc:s,toolButtonComponents:c,imageURLPrefix:h}),t),i.renderComponent(n({lc:s}),e)},e.exports=s},{"./Options":16,"./Picker":17,"./React-shim":18,"./createToolButton":22}],24:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").ToolWithStroke,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Ellipse",e.prototype.iconName="ellipse",e.prototype.begin=function(t,e,n){return this.currentShape=i("Ellipse",{x:t,y:e,strokeWidth:this.strokeWidth,strokeColor:n.getColor("primary"),fillColor:n.getColor("secondary")})},e.prototype["continue"]=function(t,e,n){return this.currentShape.width=t-this.currentShape.x,this.currentShape.height=e-this.currentShape.y,n.drawShapeInProgress(this.currentShape)},e.prototype.end=function(t,e,n){return n.saveShape(this.currentShape)},e}(o)},{"../core/shapes":7,"./base":32}],25:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./Pencil"),i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){this.strokeWidth=10}return s(e,t),e.prototype.name="Eraser",e.prototype.iconName="eraser",e.prototype.makePoint=function(t,e){return i("Point",{x:t,y:e,size:this.strokeWidth,color:"#000"})},e.prototype.makeShape=function(){return i("ErasedLinePath")},e}(o)},{"../core/shapes":7,"./Pencil":29}],26:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").Tool,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Eyedropper",e.prototype.iconName="eyedropper",e.prototype.readColor=function(t,e,n){var o;return o=n.getPixel(t,e),n.setColor("primary",o||n.getColor("background"))},e.prototype.begin=function(t,e,n){return this.readColor(t,e,n)},e.prototype["continue"]=function(t,e,n){return this.readColor(t,e,n)},e}(o)},{"../core/shapes":7,"./base":32}],27:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").ToolWithStroke,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Line",e.prototype.iconName="line",e.prototype.begin=function(t,e,n){return this.currentShape=i("Line",{x1:t,y1:e,x2:t,y2:e,strokeWidth:this.strokeWidth,color:n.getColor("primary")})},e.prototype["continue"]=function(t,e,n){return this.currentShape.x2=t,this.currentShape.y2=e,n.drawShapeInProgress(this.currentShape)},e.prototype.end=function(t,e,n){return n.saveShape(this.currentShape)},e}(o)},{"../core/shapes":7,"./base":32}],28:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").Tool,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Pan",e.prototype.iconName="pan",e.prototype.begin=function(t,e){return this.start={x:t,y:e}},e.prototype["continue"]=function(t,e,n){return n.pan(this.start.x-t,this.start.y-e),n.repaintAllLayers()},e.prototype.end=function(t,e,n){return n.repaintAllLayers()},e}(o)},{"../core/shapes":7,"./base":32}],29:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").ToolWithStroke,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Pencil",e.prototype.iconName="pencil",e.prototype.eventTimeThreshold=10,e.prototype.begin=function(t,e,n){return this.color=n.getColor("primary"),this.currentShape=this.makeShape(),this.currentShape.addPoint(this.makePoint(t,e,n)),this.lastEventTime=Date.now()},e.prototype["continue"]=function(t,e,n){var o;return o=Date.now()-this.lastEventTime,o>this.eventTimeThreshold?(this.lastEventTime+=o,this.currentShape.addPoint(this.makePoint(t,e,n)),n.drawShapeInProgress(this.currentShape)):void 0},e.prototype.end=function(t,e,n){return n.saveShape(this.currentShape),this.currentShape=void 0},e.prototype.makePoint=function(t,e){return i("Point",{x:t,y:e,size:this.strokeWidth,color:this.color})},e.prototype.makeShape=function(){return i("LinePath")},e}(o)},{"../core/shapes":7,"./base":32}],30:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").ToolWithStroke,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.name="Rectangle",e.prototype.iconName="rectangle",e.prototype.begin=function(t,e,n){return this.currentShape=i("Rectangle",{x:t,y:e,strokeWidth:this.strokeWidth,strokeColor:n.getColor("primary"),fillColor:n.getColor("secondary")})},e.prototype["continue"]=function(t,e,n){return this.currentShape.width=t-this.currentShape.x,this.currentShape.height=e-this.currentShape.y,n.drawShapeInProgress(this.currentShape)},e.prototype.end=function(t,e,n){return n.saveShape(this.currentShape)},e}(o)},{"../core/shapes":7,"./base":32}],31:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("./base").Tool,i=t("../core/shapes").createShape,e.exports=n=function(t){function e(t,e){this.text=null!=t?t:"",this.font=null!=e?e:"bold 18px sans-serif"}return s(e,t),e.prototype.name="Text",e.prototype.iconName="text",e.prototype.setText=function(t){return this.text=t},e.prototype.begin=function(t,e,n){return this.color=n.getColor("primary"),this.currentShape=i("Text",{x:t,y:e,text:this.text,color:this.color,font:this.font})},e.prototype["continue"]=function(t,e,n){return this.currentShape.x=t,this.currentShape.y=e,n.drawShapeInProgress(this.currentShape)},e.prototype.end=function(t,e,n){return n.saveShape(this.currentShape)},e.prototype.optionsStyle="font",e}(o)},{"../core/shapes":7,"./base":32}],32:[function(t,e){var n,o,i,r={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var o in e)r.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i={},i.Tool=n=function(){function t(){}return t.prototype.name=null,t.prototype.iconName=null,t.prototype.begin=function(){},t.prototype["continue"]=function(){},t.prototype.end=function(){},t.prototype.optionsStyle=null,t}(),i.ToolWithStroke=o=function(t){function e(){this.strokeWidth=5}return s(e,t),e.prototype.optionsStyle="stroke-width",e}(n),e.exports=i},{}]},{},[9])(9)});